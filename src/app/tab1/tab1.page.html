<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-title>Inicio</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Inicio</ion-title>
    </ion-toolbar>
  </ion-header>

  @if (userRole === 'administrador') {
    <ion-list [inset]="true">
      <ion-list-header><ion-label>Gestión de Usuarios</ion-label></ion-list-header>
      <ion-item button="true" detail="true" (click)="goTo('/user-list')">
        <ion-icon [icon]="icons['peopleCircleOutline']" slot="start"></ion-icon>
        <ion-label>Gestionar Todos los Usuarios</ion-label>
      </ion-item>
      
      <ion-list-header><ion-label>Gestión Académica</ion-label></ion-list-header>
      <ion-item button="true" detail="true" (click)="goTo('/manage-courses')">
        <ion-icon [icon]="icons['libraryOutline']" slot="start"></ion-icon>
        <ion-label>Gestionar Cursos</ion-label>
      </ion-item>
      <ion-item button="true" detail="true" (click)="goTo('/grade-management')">
        <ion-icon [icon]="icons['schoolOutline']" slot="start"></ion-icon>
        <ion-label>Gestionar Grados y Secciones</ion-label>
      </ion-item>
    </ion-list>
  }

  <ion-list-header class="ion-padding-start ion-padding-end">
    <ion-label>Calendario de Eventos</ion-label>
    @if (userRole === 'administrador') {
      <ion-button (click)="goToCreateEvent()" fill="clear" title="Crear nuevo evento">
        <ion-icon slot="icon-only" [icon]="icons['addCircleOutline']"></ion-icon>
      </ion-button>
    }
  </ion-list-header>
  <ion-card>
    <ion-card-content>
      <ion-datetime presentation="date" [value]="fechaSeleccionada" (ionChange)="onDateChange($event)"></ion-datetime>
    </ion-card-content>
  </ion-card>

  <ion-list [inset]="true">
    @if (eventosDelDia.length > 0) {
      @for (evento of eventosDelDia; track evento.id) {
        <ion-item>
          <ion-icon [icon]="icons['calendarOutline']" slot="start" color="primary"></ion-icon>
          <ion-label>
            <h2>{{ evento.titulo }}</h2>
            <p>{{ evento.descripcion }}</p>
          </ion-label>
        </ion-item>
      }
    } @else {
      <ion-item lines="none"><ion-label class="ion-text-center">No hay eventos programados para este día.</ion-label></ion-item>
    }
  </ion-list>

  <ion-list-header class="ion-padding-start ion-padding-end">
    <ion-label>Últimos Comunicados</ion-label>
  </ion-list-header>

  @if (comunicados.length > 0) {
    @for (comunicado of comunicados; track comunicado.id) {
      <ion-card>
        <ion-card-header>
          <ion-card-title>{{ comunicado.titulo }}</ion-card-title>
          @if(comunicado.fecha) {
            <ion-card-subtitle>{{ comunicado.fecha | date:'fullDate':'':'es-PE' }}</ion-card-subtitle>
          }
        </ion-card-header>
        <ion-card-content>{{ comunicado.mensaje }}</ion-card-content>
        @if (userRole === 'administrador') {
          <ion-footer class="ion-no-border">
            <ion-toolbar>
              <ion-buttons slot="end">
                <ion-button (click)="editComunicado(comunicado.id, $event)">
                  <ion-icon slot="icon-only" [icon]="icons['createOutline']"></ion-icon>
                </ion-button>
                <ion-button (click)="deleteComunicado(comunicado.id, $event)" color="danger">
                  <ion-icon slot="icon-only" [icon]="icons['trashOutline']"></ion-icon>
                </ion-button>
              </ion-buttons>
            </ion-toolbar>
          </ion-footer>
        }
      </ion-card>
    }
  } @else {
    <div class="ion-text-center ion-padding">
      <p>No hay comunicados para mostrar.</p>
    </div>
  }

  @if (userRole === 'administrador') {
    <ion-fab vertical="bottom" horizontal="end" slot="fixed">
      <ion-fab-button (click)="goToCreateComunicado()">
        <ion-icon [icon]="icons['add']"></ion-icon>
      </ion-fab-button>
    </ion-fab>
  }

</ion-content>


